@model List<Sewa360.Areas.Admin.Models.Certificates>
@{
    Layout = "~/Areas/Admin/views/shared/_dashboardlayout.cshtml";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Certificate of Internship</title>
    <style>
        body {
            margin: 0;
            padding: 15px;
            font-family: 'Times New Roman', serif;
            background: #f4f4f9;
        }

        .certificate-wrapper {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            overflow-x: auto; /* Prevent cut on small screens */
        }

        /* Certificate Container */
        .certificate-container {
            width: 1120px;
            height: 790px;
            padding: 50px 60px;
            background: linear-gradient(135deg, #fff 0%, #fdfaf3 100%);
            border: 14px double #c09a3e;
            border-radius: 20px;
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.25);
            box-sizing: border-box;
            overflow: hidden;
            background-image: radial-gradient(circle at center, rgba(0,0,0,0.02) 1px, transparent 1px);
            background-size: 26px 26px;
            min-width: 1120px;
        }

            .certificate-container::before {
                content: "SEWA360";
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 110px;
                font-weight: bold;
                color: rgba(200, 180, 120, 0.12);
                white-space: nowrap;
                letter-spacing: 15px;
                pointer-events: none;
            }

        /* Header */
        .certificate-header {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 25px;
            color: #555;
        }

        /* Title */
        .certificate-title {
            text-align: center;
            font-size: clamp(26px, 4vw, 42px);
            font-weight: bold;
            text-transform: uppercase;
            margin: 25px 0 35px;
            letter-spacing: 3px;
            color: #c09a3e;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }

        /* Body */
        .certificate-body {
            text-align: center;
            font-size: clamp(15px, 2vw, 22px);
            line-height: 1.9;
            color: #333;
        }

        .cert-name {
            font-size: clamp(20px, 2.5vw, 30px);
            font-weight: bold;
            text-decoration: underline;
            margin: 20px 0;
            color: #000;
        }

        /* Footer */
        .certificate-footer {
            text-align: center;
            margin-top: 40px;
            font-size: 13px;
            font-weight: bold;
            letter-spacing: 1px;
            color: #444;
        }

        /* Signatures BELOW footer */
        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 180px;
            padding: 0 50px;
        }

        .signature-block {
            text-align: center;
            width: 40%;
            font-size: 15px;
            color: #222;
        }

        .sign-line {
            border-top: 2px solid #000;
            width: 70%;
            margin: 0 auto 10px;
        }

        /* Buttons */
        .action-buttons {
            text-align: center;
            margin-bottom: 10px;
        }

        .btn-action {
            padding: 8px 16px;
            font-size: 14px;
            margin: 0 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-download {
            background: #28a745;
            color: #fff;
        }

        .btn-print {
            background: #007bff;
            color: #fff;
        }

        /* Mobile Scaling */
        @@media (max-width: 768px) {
            .certificate-container

        {
            transform: scale(0.75);
            transform-origin: top center;
        }

        .certificate-wrapper {
            padding-bottom: 40px;
        }

        }

        @@media (max-width: 480px) {
            .certificate-container

        {
            transform: scale(0.6);
            transform-origin: top center;
        }

        }
    </style>
</head>
<body>
    <div class="container">
        @foreach (var cert in Model)
        {
            <div class="action-buttons">
                <button class="btn-action btn-print" onclick="printCertificate('cert-@cert.Student_Id', '@cert.FullName')">🖨️ Print</button>
                <button class="btn-action btn-download" onclick="downloadPDF('cert-@cert.Student_Id', '@cert.FullName')">⬇️ Download</button>
            </div>

            <div class="certificate-wrapper">
                <div class="certificate-container" id="cert-@cert.Student_Id">
                    <!-- Header -->
                    <div class="certificate-header">
                        <div>ESTD: @cert.CreatedAt.ToString("yyyy")</div>
                        <div>Sl. No: @cert.Student_Id</div>
                    </div>

                    <!-- Title -->
                    <div class="certificate-title">Certificate of Internship</div>

                    <!-- Body -->
                    <div class="certificate-body">
                        This is to certify that <br />
                        <span class="cert-name">@cert.FullName</span><br />
                        has successfully completed an internship from <br />
                        <b>@cert.StartDate?.ToString("dd MMM yyyy")</b> to <b>@cert.EndDate?.ToString("dd MMM yyyy")</b><br />
                        at <b>@cert.CompanyName</b>.
                    </div>

                   

                    <!-- Signatures BELOW footer -->
                    <div class="signatures">
                        <div class="signature-block">
                            <div class="sign-line"></div>
                            Program Coordinator
                        </div>
                        <div class="signature-block">
                            <div class="sign-line"></div>
                            Director
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="certificate-footer">
                        This certificate is issued by @cert.CompanyName
                    </div>

                </div>
            </div>
        }
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script>
        function downloadPDF(certId, name) {
            var element = document.getElementById(certId);
            var opt = {
                margin: 0,
                filename: name + '_Certificate.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'px', format: [1120, 790], orientation: 'landscape' }
            };
            html2pdf().from(element).set(opt).save();
        }

        function printCertificate(certId, name) {
            var element = document.getElementById(certId);
            var opt = {
                margin: 0,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true },
                jsPDF: { unit: 'px', format: [1120, 790], orientation: 'landscape' }
            };

            html2pdf().from(element).set(opt).toPdf().get('pdf').then(function (pdf) {
                var blobUrl = pdf.output('bloburl');
                var printWindow = window.open(blobUrl, '_blank');
                printWindow.onload = function () {
                    printWindow.focus();
                    printWindow.print();
                };
            });
        }
    </script>
</body>
</html>
